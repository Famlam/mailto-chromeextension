window.addEventListener("load",function(){var i;var u=[];var v=document.querySelectorAll("[href]");for(i=0;i<v.length;i++){if(/^mailto\:.+/i.test(v[i].href)){u.push(v[i])}}window.removeEventListener("load",arguments.callee);if(u.length){var w=function(e){chrome.extension.sendRequest("email",function(f){var g=function(a,b,c,d){if(!a){return""}if(c){a=a.replace(/(^|\,)[^\,]*\<(.+?\@.+?\..+?)\>/g,"$1$2")}if(d){a=a.replace(/\,/g,';')}return(b||"")+window.escape(a)};var h=e.target;while(!h.href&&h.parentNode){h=h.parentNode}var j=(h.href||"").match(/^mailto\:(.+)$/i);if(!j){return}var i;var k={};var l=("to="+j[1]).replace(/\?/,'&').split('&');for(i=0;i<l.length;i++){var m=l[i].split('=');var n=m[0].toLowerCase();if(k[n]){if(m[1]&&(n==="to"||n==="bcc"||n==="cc")){m[1]=k[n]+", "+m[1]}else if(n==="body"){m[1]=k[n]+"%0D%0A"+m[1]}}if(m[1]){k[n]=window.unescape(m[1]||"")}}var o="";switch(f){case"wlm":case"hotmail":var p="compose?To="+g(k.to,"",true,true)+g(k.cc,"&CC=",true,true)+g(k.subject,"&subject=")+g(k.body,"&body=");o="http://mail.live.com/?rru="+window.escape(p);break;case"gmail":var q=g(k.to,"",true)+g(k.cc,"&cc=",true)+g(k.bcc,"&bcc=",true)+g(k.subject,"&su=")+g(k.body,"&body=");o="https://mail.google.com/mail/?view=cm&tf=1&to="+q;break;case"ymail":var r=g(k.to,"",true)+g(k.cc,"&Cc=",true)+g(k.bcc,"&Bcc=",true)+g(k.subject,"&Subject=")+g(k.body,"&Body=");o="http://compose.mail.yahoo.com/?To="+r;break;case"zoho":var s=g(k.to,"",true);o="https://zmail.zoho.com/mail/compose.do?extsrc=mailto&mode=compose&tp=zb&ct="+s;break;case"fastmail":var t=g(k.to,"",true)+g(k.cc,"&cc=",true)+g(k.bcc,"&bcc=",true)+g(k.subject,"&subject=")+g(k.body,"&body=");o="http://ssl.fastmail.fm/action/compose/?to="+t;break}window.open(o)});e.preventDefault()};for(i=0;i<u.length;i++){u[i].addEventListener('click',w)}}});