window.addEventListener("load",function(){var i;var s=[];var t=document.querySelectorAll("[href]");for(i=0;i<t.length;i++){if(/^mailto\:.+/i.test(t[i].href))s.push(t[i])}window.removeEventListener("load",arguments.callee);if(s.length){chrome.extension.sendRequest("email",function(e){var f;var i;for(f=0;f<s.length;f++){var g=s[f].href.match(/^mailto\:(.+)$/i);if(!g)continue;var h={};var j=("to="+g[1]).replace(/\?/,'&').split('&');for(i=0;i<j.length;i++){var k=j[i].split('=');var l=k[0].toLowerCase();if(h[l]){if(k[1]&&(l=="to"||l=="bcc"||l=="cc"))k[1]=h[l]+", "+k[1];else if(l=="body")k[1]=h[l]+"%0D%0A"+k[1]}if(k[1])h[l]=unescape(k[1]||"")}var m=function(a,b,c,d){if(!a)return"";if(c)a=a.replace(/(^|\,)[^\,]*\<(.+?\@.+?\..+?)\>/g,"$1$2");if(d)a=a.replace(/\,/g,';');return(b||"")+escape(a)};var n="";switch(e){case"wlm":case"hotmail":var o="compose?To=";o+=m(h.to,"",true,true);o+=m(h.cc,"&CC=",true,true);o+=m(h.subject,"&subject=");o+=m(h.body,"&body=");n="http://mail.live.com/?rru="+escape(o);break;case"gmail":var p=m(h.to,"",true);p+=m(h.cc,"&cc=",true);p+=m(h.bcc,"&bcc=",true);p+=m(h.subject,"&su=");p+=m(h.body,"&body=");n="https://mail.google.com/mail/?view=cm&tf=1&to="+p;break;case"ymail":var q=m(h.to,"",true);q+=m(h.cc,"&Cc=",true);q+=m(h.bcc,"&Bcc=",true);q+=m(h.subject,"&Subject=");q+=m(h.body,"&Body=");n="http://compose.mail.yahoo.com/?To="+q;break;case"zoho":var r=m(h.to,"",true);n="https://zmail.zoho.com/mail/compose.do?extsrc=mailto&mode=compose&tp=zb&ct="+r;break}n=n.replace("'",'"');s[f].setAttribute("onclick","window.open('"+n+"', '_new');return false;")}})}});